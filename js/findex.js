









function Vector(t,i){this.x=t||0,this.y=i||0}function GravityPoint(t,i,e,r){Vector.call(this,t,i),this.radius=e,this.currentRadius=.5*e,this._targets={particles:r.particles||[],gravities:r.gravities||[]},this._speed=new Vector}function Particle(t,i,e){Vector.call(this,t,i),this.radius=e,this._latest=new Vector,this._speed=new Vector}window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),Vector.add=function(t,i){return new Vector(t.x+i.x,t.y+i.y)},Vector.sub=function(t,i){return new Vector(t.x-i.x,t.y-i.y)},Vector.scale=function(t,i){return t.clone().scale(i)},Vector.random=function(){return new Vector(2*Math.random()-1,2*Math.random()-1)},Vector.prototype={set:function(t,i){return"object"==typeof t&&(i=t.y,t=t.x),this.x=t||0,this.y=i||0,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this},scale:function(t){return this.x*=t,this.y*=t,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSq:function(){return this.x*this.x+this.y*this.y},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return t&&(this.x/=t,this.y/=t),this},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){var i=t.x-this.x,e=t.y-this.y;return Math.atan2(e,i)},distanceTo:function(t){var i=t.x-this.x,e=t.y-this.y;return Math.sqrt(i*i+e*e)},distanceToSq:function(t){var i=t.x-this.x,e=t.y-this.y;return i*i+e*e},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},clone:function(){return new Vector(this.x,this.y)},toString:function(){return"(x:"+this.x+", y:"+this.y+")"}},GravityPoint.RADIUS_LIMIT=55,GravityPoint.interferenceToPoint=!0,GravityPoint.prototype=function(t){var i,e=new Vector(0,0);for(i in t)e[i]=t[i];return e}({gravity:.05,isMouseOver:!1,dragging:!1,destroyed:!1,_easeRadius:0,_dragDistance:null,_collapsing:!1,hitTest:function(t){return this.distanceTo(t)<this.radius},startDrag:function(t){this._dragDistance=Vector.sub(t,this),this.dragging=!0},drag:function(t){this.x=t.x-this._dragDistance.x,this.y=t.y-this._dragDistance.y},endDrag:function(){this._dragDistance=null,this.dragging=!1},addSpeed:function(t){this._speed=this._speed.add(t)},collapse:function(t){this.currentRadius*=1.75,this._collapsing=!0},render:function(t){if(!this.destroyed){var i,e,r=this._targets.particles;for(i=0,e=r.length;e>i;i++)r[i].addSpeed(Vector.sub(this,r[i]).normalize().scale(this.gravity));if(this._easeRadius=.95*(this._easeRadius+.07*(this.radius-this.currentRadius)),this.currentRadius+=this._easeRadius,this.currentRadius<0&&(this.currentRadius=0),this._collapsing)return this.radius*=.75,this.currentRadius<1&&(this.destroyed=!0),void this._draw(t);var s,n,a,o=this._targets.gravities,h=this.radius*this.radius*Math.PI;for(i=0,e=o.length;e>i;i++)s=o[i],s===this||s.destroyed||((this.currentRadius>=s.radius||this.dragging)&&this.distanceTo(s)<.85*(this.currentRadius+s.radius)&&(s.destroyed=!0,this.gravity+=s.gravity,n=Vector.sub(s,this).scale(s.radius/this.radius*.5),this.addSpeed(n),a=s.radius*s.radius*Math.PI,this.currentRadius=Math.sqrt((h+3*a)/Math.PI),this.radius=Math.sqrt((h+a)/Math.PI)),s.addSpeed(Vector.sub(this,s).normalize().scale(this.gravity)));GravityPoint.interferenceToPoint&&!this.dragging&&this.add(this._speed),this._speed=new Vector,this.currentRadius>GravityPoint.RADIUS_LIMIT&&this.collapse(),this._draw(t)}},_draw:function(t){var i,e;t.save(),i=t.createRadialGradient(this.x,this.y,this.radius,this.x,this.y,5*this.radius),i.addColorStop(0,"rgba(212, 175, 55, 0.09)"),i.addColorStop(1,"rgba(0, 0,0, 0)"),t.beginPath(),t.arc(this.x,this.y,5*this.radius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),e=Math.random()*this.currentRadius*.7+.3*this.currentRadius,i=t.createRadialGradient(this.x,this.y,e,this.x,this.y,this.currentRadius),i.addColorStop(0,"rgba(0, 0, 0, 1)"),i.addColorStop(1,Math.random()<.2?"rgba(220, 0, 0, 0.3)":"rgba(0, 0, 160, 0.55)"),t.beginPath(),t.arc(this.x,this.y,this.currentRadius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),t.restore()}}),Particle.prototype=function(t){var i,e=new Vector(0,0);for(i in t)e[i]=t[i];return e}({addSpeed:function(t){this._speed.add(t)},update:function(){this._speed.length()>12&&this._speed.normalize().scale(12),this._latest.set(this),this.add(this._speed)}}),function(){function t(t){u=a.width=window.innerWidth,c=a.height=window.innerHeight,h.width=u,h.height=c,o=a.getContext("2d"),d=h.getContext("2d");var i=.5*a.width,e=.5*a.height;l=o.createRadialGradient(i,e,0,i,e,Math.sqrt(i*i+e*e)),l.addColorStop(0,"#000000"),l.addColorStop(1,"black")}function i(t){p.set(t.clientX,t.clientY);var i,e,r=!1;for(i=x.length-1;i>=0;i--)e=x[i],!r&&e.hitTest(p)||e.dragging?e.isMouseOver=r=!0:e.isMouseOver=!1;a.style.cursor=r?"pointer":"default"}function e(t){for(var i=x.length-1;i>=0;i--)if(x[i].isMouseOver)return void x[i].startDrag(p);x.push(new GravityPoint(t.clientX,t.clientY,v,{particles:m,gravities:x}))}function r(t){for(var i=0,e=x.length;e>i;i++)if(x[i].dragging){x[i].endDrag();break}}function s(t){for(var i=x.length-1;i>=0;i--)if(x[i].isMouseOver){x[i].collapse();break}}function n(t){var i,e;for(i=0;t>i;i++)e=new Particle(Math.floor(Math.random()*u-2*y)+1+y,Math.floor(Math.random()*c-2*y)+1+y,y),e.addSpeed(Vector.random()),m.push(e)}var a,o,h,d,u,c,l,g,f="black",y=1,v=10,p=new Vector,x=[],m=[];g={particleNum:210},a=document.getElementById("c"),h=document.createElement("canvas"),window.addEventListener("resize",t,!1),t(null),n(g.particleNum),a.addEventListener("mousemove",i,!1),a.addEventListener("mousedown",e,!1),a.addEventListener("mouseup",r,!1),a.addEventListener("dblclick",s,!1);var w=function(){var t,i,e,r;for(o.save(),o.fillStyle=f,o.fillRect(0,0,u,c),o.fillStyle=l,o.fillRect(0,0,u,c),o.restore(),t=0,i=x.length;i>t;t++)e=x[t],e.dragging&&e.drag(p),e.render(o),e.destroyed&&(x.splice(t,1),i--,t--);for(d.save(),d.globalCompositeOperation="destination-out",d.globalAlpha=.35,d.fillRect(0,0,u,c),d.restore()/*#rubixcode*/,i=m.length,d.save(),d.fillStyle=d.strokeStyle="#D4AF37",d.lineCap=d.lineJoin="round",d.lineWidth=2*y,d.beginPath(),t=0;i>t;t++)r=m[t],r.update(),d.moveTo(r.x,r.y),d.lineTo(r._latest.x,r._latest.y);for(d.stroke(),d.beginPath(),t=0;i>t;t++)r=m[t],d.moveTo(r.x,r.y),d.arc(r.x,r.y,r.radius,0,2*Math.PI,!1);d.fill(),d.restore(),o.drawImage(h,0,0),requestAnimationFrame(w)};w()}();

